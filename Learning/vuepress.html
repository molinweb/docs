<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>介绍 | 漠林</title>
    <meta name="description" content=" 耕耘漠林里，最美柒月天。风雨随缘至，草木自盎然。">
    <link rel="icon" href="/docs/favicon.ico">
    
    <link rel="preload" href="/docs/assets/css/0.styles.477c69b1.css" as="style"><link rel="preload" href="/docs/assets/js/app.5baed39a.js" as="script"><link rel="preload" href="/docs/assets/js/12.725ee489.js" as="script"><link rel="preload" href="/docs/assets/js/2.63264812.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.8978b2ec.js"><link rel="prefetch" href="/docs/assets/js/11.b5717aed.js"><link rel="prefetch" href="/docs/assets/js/13.6ef53374.js"><link rel="prefetch" href="/docs/assets/js/14.32d6e4c2.js"><link rel="prefetch" href="/docs/assets/js/15.ad20e6b2.js"><link rel="prefetch" href="/docs/assets/js/16.952fef5a.js"><link rel="prefetch" href="/docs/assets/js/17.855b0d3b.js"><link rel="prefetch" href="/docs/assets/js/18.3641178c.js"><link rel="prefetch" href="/docs/assets/js/19.5de18ed0.js"><link rel="prefetch" href="/docs/assets/js/20.1f9991ea.js"><link rel="prefetch" href="/docs/assets/js/21.3e964fb7.js"><link rel="prefetch" href="/docs/assets/js/22.ae3912fd.js"><link rel="prefetch" href="/docs/assets/js/23.5e7e10c0.js"><link rel="prefetch" href="/docs/assets/js/24.504324a3.js"><link rel="prefetch" href="/docs/assets/js/25.d9c755fc.js"><link rel="prefetch" href="/docs/assets/js/3.0f980849.js"><link rel="prefetch" href="/docs/assets/js/4.a4618c7e.js"><link rel="prefetch" href="/docs/assets/js/5.747c7a0c.js"><link rel="prefetch" href="/docs/assets/js/6.5a84610a.js"><link rel="prefetch" href="/docs/assets/js/7.54a5d5c1.js"><link rel="prefetch" href="/docs/assets/js/8.0c3cfff3.js"><link rel="prefetch" href="/docs/assets/js/9.5a5a6f5c.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.477c69b1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">漠林</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/" class="nav-link">Home</a></div><div class="nav-item"><a href="/docs/React/" class="nav-link">React</a></div><div class="nav-item"><a href="/docs/Java/" class="nav-link">Java</a></div><div class="nav-item"><a href="/docs/Learning/" class="nav-link router-link-active">Learning</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/" class="nav-link">Home</a></div><div class="nav-item"><a href="/docs/React/" class="nav-link">React</a></div><div class="nav-item"><a href="/docs/Java/" class="nav-link">Java</a></div><div class="nav-item"><a href="/docs/Learning/" class="nav-link router-link-active">Learning</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/docs/Learning/vuepress.html" class="active sidebar-link">VuePress教程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#快速上手" class="sidebar-link">快速上手</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#全局安装" class="sidebar-link">@全局安装</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#构建项目" class="sidebar-link">构建项目</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#项目结构" class="sidebar-link">项目结构</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#配置package-json" class="sidebar-link">配置package.json</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#安装依赖" class="sidebar-link">安装依赖</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#运行" class="sidebar-link">运行</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#编译" class="sidebar-link">编译</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#配置默认主题" class="sidebar-link">配置默认主题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#首页" class="sidebar-link">首页</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#导航栏" class="sidebar-link">导航栏</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#侧边栏" class="sidebar-link">侧边栏</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#嵌套的标题链接" class="sidebar-link">嵌套的标题链接</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#显示所有页面的标题链接" class="sidebar-link">显示所有页面的标题链接</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#侧边栏分组" class="sidebar-link">侧边栏分组</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#多个侧边栏" class="sidebar-link">多个侧边栏</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#自定义默认主题颜色" class="sidebar-link">自定义默认主题颜色</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#部署到git" class="sidebar-link">部署到Git</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#前提" class="sidebar-link">前提</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#准备" class="sidebar-link">准备</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#ssh-key" class="sidebar-link">SSH Key</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#开始" class="sidebar-link">开始</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#成果" class="sidebar-link">成果</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#进阶" class="sidebar-link">进阶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#自定义vue组件" class="sidebar-link">自定义Vue组件</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#使用elementui" class="sidebar-link">使用ElementUI</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#travis-ci-持续集成部署" class="sidebar-link">Travis CI 持续集成部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#现有问题" class="sidebar-link">现有问题</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#引入" class="sidebar-link">引入</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#准备-2" class="sidebar-link">准备</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#travis-ci配置" class="sidebar-link">Travis CI配置</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#测试-2" class="sidebar-link">测试</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#发布到服务器" class="sidebar-link">发布到服务器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#ssh免密登录" class="sidebar-link">SSH免密登录</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#加密" class="sidebar-link">加密</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#执行部署脚本" class="sidebar-link">执行部署脚本</a></li><li class="sidebar-sub-header"><a href="/docs/Learning/vuepress.html#部署测试" class="sidebar-link">部署测试</a></li></ul></li></ul></li><li><a href="/docs/Learning/publish.html" class="sidebar-link">观察者模式&amp;&amp;发布-订阅模式</a></li><li><a href="/docs/Learning/bind.html" class="sidebar-link">双向数据绑定</a></li><li><a href="/docs/Learning/loop.html" class="sidebar-link">事件循环</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="介绍"><a href="#介绍" aria-hidden="true" class="header-anchor">#</a> 介绍</h1> <p>VuePress 由两部分组成：一部分是支持用 Vue 开发主题的极简静态网站生成器，另一个部分是为书写技术文档而优化的默认主题。它的诞生初衷是为了支持 Vue 及其子项目的文档需求。
每一个由 VuePress 生成的页面都带有预渲染好的 HTML，也因此具有非常好的加载性能和搜索引擎优化（SEO）。同时，一旦页面被加载，Vue 将接管这些静态内容，并将其转换成一个完整的单页应用（SPA），其他的页面则会只在用户浏览到的时候才按需加载。</p> <h2 id="快速上手"><a href="#快速上手" aria-hidden="true" class="header-anchor">#</a> 快速上手</h2> <div class="warning custom-block"><p class="custom-block-title">注意：</p> <p>请确保你的 Node.js 版本 &gt;= 8。</p></div> <h2 id="全局安装"><a href="#全局安装" aria-hidden="true" class="header-anchor">#</a> @全局安装</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> -g vuepress
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">注意</p> <p>全局安装vuepress会和<code>webpack-dev-middleware@3.6.1</code>冲突，导致运行意外报错</p></div> <h2 id="构建项目"><a href="#构建项目" aria-hidden="true" class="header-anchor">#</a> 构建项目</h2> <h3 id="项目结构"><a href="#项目结构" aria-hidden="true" class="header-anchor">#</a> 项目结构</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 新建项目</span>
<span class="token function">mkdir</span> my_blog
<span class="token function">cd</span> my_blog
<span class="token comment"># 新建文档目录</span>
<span class="token function">mkdir</span> docs 
<span class="token function">mkdir</span> docs/.vuepress
<span class="token comment"># 创建配置文件</span>
<span class="token function">touch</span> package.json
<span class="token function">touch</span> docs/.vuepress/config.js
<span class="token comment"># 创建第一个文档</span>
<span class="token function">touch</span> docs/README.md
</code></pre></div><p>此时项目目录为</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>my_blog
├─── docs <span class="token comment">//文档目录</span>
│   ├── <span class="token constant">README</span><span class="token punctuation">.</span>md <span class="token comment">//第一篇文档 `hello vuepress`</span>
│   └── <span class="token punctuation">.</span>vuepress <span class="token comment">//主要用于存放VuePress相关的文件</span>
│       └── config<span class="token punctuation">.</span>js <span class="token comment">//VuePress必要的配置文件</span>
└── <span class="token keyword">package</span><span class="token punctuation">.</span>json

</code></pre></div><h3 id="配置package-json"><a href="#配置package-json" aria-hidden="true" class="header-anchor">#</a> 配置package.json</h3> <p>VuePress中有两个命令，vuepress dev docs命令运行本地服务，通过访问http://localhost:8080即可预览网站，vuepress build docs命令用来生成静态文件，默认情况下，放置在docs/.vuepress/dist目录中，当然你也可以在docs/.vuepress/config.js中的dest字段来修改默认存放目录。在这里将两个命令封装成脚本的方式，直接使用npm run docs:dev和npm run docs:build即可</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;scripts&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;docs:dev&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;vuepress dev docs&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;docs:build&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;vuepress build docs&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;dependencies&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;vuepress&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;^0.14.10&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;resolutions&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;webpack-dev-middleware&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;3.6.0&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>这里手动引入<code>vuepress</code>和<code>webpack-dev-middleware@3.6.0</code></p></blockquote> <h3 id="安装依赖"><a href="#安装依赖" aria-hidden="true" class="header-anchor">#</a> 安装依赖</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">yarn</span> <span class="token comment"># 或者  npm i</span>
</code></pre></div><h3 id="运行"><a href="#运行" aria-hidden="true" class="header-anchor">#</a> 运行</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">yarn</span> docs:dev <span class="token comment"># 或者：npm run docs:dev </span>
<span class="token comment"># 全局安装可直接执行 vuepress dev</span>
</code></pre></div><h3 id="编译"><a href="#编译" aria-hidden="true" class="header-anchor">#</a> 编译</h3> <p>要生成静态的 HTML 文件，运行</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">yarn</span> docs:build <span class="token comment"># 或者：npm run docs:build </span>
<span class="token comment"># 全局安装可直接执行 vuepress build</span>
</code></pre></div><h2 id="配置默认主题"><a href="#配置默认主题" aria-hidden="true" class="header-anchor">#</a> 配置默认主题</h2> <h3 id="首页"><a href="#首页" aria-hidden="true" class="header-anchor">#</a> 首页</h3> <p>默认的主题提供了一个首页（Homepage）的布局，
编辑根目录下的README.md文件</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">--</span><span class="token operator">-</span>
home<span class="token punctuation">:</span> <span class="token boolean">true</span>
heroImage<span class="token punctuation">:</span> <span class="token operator">/</span>hero<span class="token punctuation">.</span>png
actionText<span class="token punctuation">:</span> 快速上手 →
actionLink<span class="token punctuation">:</span> <span class="token operator">/</span>zh<span class="token operator">/</span>guide<span class="token operator">/</span>
features<span class="token punctuation">:</span>
<span class="token operator">-</span> title<span class="token punctuation">:</span> 简洁至上
  details<span class="token punctuation">:</span> 以 Markdown 为中心的项目结构，以最少的配置帮助你专注于写作。
<span class="token operator">-</span> title<span class="token punctuation">:</span> Vue驱动
  details<span class="token punctuation">:</span> 享受 Vue <span class="token operator">+</span> webpack 的开发体验，在 Markdown 中使用 Vue 组件，同时可以使用 Vue 来开发自定义主题。
<span class="token operator">-</span> title<span class="token punctuation">:</span> 高性能
  details<span class="token punctuation">:</span> VuePress 为每个页面预渲染生成静态的 <span class="token constant">HTML</span>，同时在页面被加载的时候，将作为 <span class="token constant">SPA</span> 运行。
footer<span class="token punctuation">:</span> <span class="token constant">MIT</span> Licensed <span class="token operator">|</span> Copyright © <span class="token number">2018</span><span class="token operator">-</span>present Evan You
<span class="token operator">--</span><span class="token operator">-</span>
</code></pre></div><h3 id="导航栏"><a href="#导航栏" aria-hidden="true" class="header-anchor">#</a> 导航栏</h3> <p>导航栏可能包含你的页面标题、搜索框、 导航栏链接、多语言切换等等，它们均取决于你的配置。</p> <h4 id="导航栏链接"><a href="#导航栏链接" aria-hidden="true" class="header-anchor">#</a> 导航栏链接</h4> <p>可以通过 themeConfig.nav 增加一些导航栏链接</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .vuepress/config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  themeConfig<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    nav<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> text<span class="token punctuation">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span> link<span class="token punctuation">:</span> <span class="token string">'/'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> text<span class="token punctuation">:</span> <span class="token string">'Guide'</span><span class="token punctuation">,</span> link<span class="token punctuation">:</span> <span class="token string">'/guide/'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> text<span class="token punctuation">:</span> <span class="token string">'External'</span><span class="token punctuation">,</span> link<span class="token punctuation">:</span> <span class="token string">'https://google.com'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>当提供了一个 items 数组而不是一个单一的 link 时，它将显示为一个 下拉列表 ：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  themeConfig<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    nav<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        text<span class="token punctuation">:</span> <span class="token string">'Languages'</span><span class="token punctuation">,</span>
        items<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span> text<span class="token punctuation">:</span> <span class="token string">'Chinese'</span><span class="token punctuation">,</span> link<span class="token punctuation">:</span> <span class="token string">'/language/chinese'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> text<span class="token punctuation">:</span> <span class="token string">'Japanese'</span><span class="token punctuation">,</span> link<span class="token punctuation">:</span> <span class="token string">'/language/japanese'</span> <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>此外，还可以通过嵌套的 items 来在 下拉列表 中设置分组：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  themeConfig<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    nav<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        text<span class="token punctuation">:</span> <span class="token string">'Languages'</span><span class="token punctuation">,</span>
        items<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span> text<span class="token punctuation">:</span> <span class="token string">'Group1'</span><span class="token punctuation">,</span> items<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token comment">/*  */</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> text<span class="token punctuation">:</span> <span class="token string">'Group2'</span><span class="token punctuation">,</span> items<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token comment">/*  */</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>可以使用 themeConfig.navbar 来禁用所有页面的导航栏：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  themeConfig<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    navbar<span class="token punctuation">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="侧边栏"><a href="#侧边栏" aria-hidden="true" class="header-anchor">#</a> 侧边栏</h3> <p>想要使 侧边栏（Sidebar）生效，需要配置 themeConfig.sidebar，基本的配置，需要一个包含了多个链接的数组：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .vuepress/config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  themeConfig<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    sidebar<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token string">'/'</span><span class="token punctuation">,</span>
      <span class="token string">'/page-a'</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token string">'/page-b'</span><span class="token punctuation">,</span> <span class="token string">'Explicit link text'</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>可以省略 .md 拓展名，同时以 / 结尾的路径将会被视为 */README.md</p></blockquote> <h3 id="嵌套的标题链接"><a href="#嵌套的标题链接" aria-hidden="true" class="header-anchor">#</a> 嵌套的标题链接</h3> <p>默认情况下，侧边栏会自动地显示由当前页面的标题（headers）组成的链接，并按照页面本身的结构进行嵌套，你可以通过 themeConfig.sidebarDepth 来修改它的行为。默认的深度是 1，它将提取到 h2 的标题，设置成 0 将会禁用标题（headers）链接，同时，最大的深度为 2，它将同时提取 h2 和 h3 标题。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">--</span><span class="token operator">-</span>
sidebarDepth<span class="token punctuation">:</span> <span class="token number">2</span>
<span class="token operator">--</span><span class="token operator">-</span>
</code></pre></div><h3 id="显示所有页面的标题链接"><a href="#显示所有页面的标题链接" aria-hidden="true" class="header-anchor">#</a> 显示所有页面的标题链接</h3> <p>默认情况下，侧边栏只会显示由当前活动页面的标题（headers）组成的链接，你可以将 themeConfig.displayAllHeaders 设置为 true 来显示所有页面的标题链接：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  themeConfig<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    displayAllHeaders<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token comment">// 默认值：false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="侧边栏分组"><a href="#侧边栏分组" aria-hidden="true" class="header-anchor">#</a> 侧边栏分组</h3> <p>可以通过使用对象来将侧边栏划分成多个组：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .vuepress/config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  themeConfig<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    sidebar<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        title<span class="token punctuation">:</span> <span class="token string">'Group 1'</span><span class="token punctuation">,</span>
        collapsable<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token string">'/'</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        title<span class="token punctuation">:</span> <span class="token string">'Group 2'</span><span class="token punctuation">,</span>
        children<span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token comment">/* ... */</span> <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="多个侧边栏"><a href="#多个侧边栏" aria-hidden="true" class="header-anchor">#</a> 多个侧边栏</h3> <p>如果你想为不同的页面组来显示不同的侧边栏，首先，将你的页面文件组织成下述的目录结构：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">.</span>
├─ <span class="token constant">README</span><span class="token punctuation">.</span>md
├─ contact<span class="token punctuation">.</span>md
├─ about<span class="token punctuation">.</span>md
├─ foo<span class="token operator">/</span>
│  ├─ <span class="token constant">README</span><span class="token punctuation">.</span>md
│  ├─ one<span class="token punctuation">.</span>md
│  └─ two<span class="token punctuation">.</span>md
└─ bar<span class="token operator">/</span>
   ├─ <span class="token constant">README</span><span class="token punctuation">.</span>md
   ├─ three<span class="token punctuation">.</span>md
   └─ four<span class="token punctuation">.</span>md
</code></pre></div><p>接着，遵循以下的侧边栏配置：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// .vuepress/config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  themeConfig<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    sidebar<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">'/foo/'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">''</span><span class="token punctuation">,</span>     <span class="token comment">/* /foo/ */</span>
        <span class="token string">'one'</span><span class="token punctuation">,</span>  <span class="token comment">/* /foo/one.html */</span>
        <span class="token string">'two'</span>   <span class="token comment">/* /foo/two.html */</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>

      <span class="token string">'/bar/'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">''</span><span class="token punctuation">,</span>      <span class="token comment">/* /bar/ */</span>
        <span class="token string">'three'</span><span class="token punctuation">,</span> <span class="token comment">/* /bar/three.html */</span>
        <span class="token string">'four'</span>   <span class="token comment">/* /bar/four.html */</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>

      <span class="token comment">// fallback</span>
      <span class="token string">'/'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">''</span><span class="token punctuation">,</span>        <span class="token comment">/* / */</span>
        <span class="token string">'contact'</span><span class="token punctuation">,</span> <span class="token comment">/* /contact.html */</span>
        <span class="token string">'about'</span>    <span class="token comment">/* /about.html */</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>确保 fallback 侧边栏被最后定义。VuePress 会按顺序遍历侧边栏配置来寻找匹配的配置。</p></div> <h3 id="自定义默认主题颜色"><a href="#自定义默认主题颜色" aria-hidden="true" class="header-anchor">#</a> 自定义默认主题颜色</h3> <p>如果你只是希望应用一些简单的 overrides 到默认主题的样式上，可以创建一个 <code>.vuepress/override.styl</code> 文件</p> <p>这里有一些可以调整的颜色变量：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// showing default values</span>
$accentColor <span class="token operator">=</span> #<span class="token number">3</span>eaf7c
$textColor <span class="token operator">=</span> #<span class="token number">2</span>c3e50
$borderColor <span class="token operator">=</span> #eaecef
$codeBgColor <span class="token operator">=</span> #<span class="token number">282</span>c34
</code></pre></div><h2 id="部署到git"><a href="#部署到git" aria-hidden="true" class="header-anchor">#</a> 部署到<code>Git</code></h2> <h3 id="前提"><a href="#前提" aria-hidden="true" class="header-anchor">#</a> 前提</h3> <p>下述的指南基于以下条件：</p> <ul><li>文档放置在项目的 docs 目录中；</li> <li>使用的是默认的构建输出位置；</li> <li>VuePress 以本地依赖的形式被安装到你的项目中，并且配置了如下的 npm scripts:</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;scripts&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;docs:build&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;vuepress build docs&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="准备"><a href="#准备" aria-hidden="true" class="header-anchor">#</a> 准备</h3> <ul><li>前往<code>github</code>，创建用于存放文档的<code>Repo</code></li> <li>开启<code>GitHub Pages</code></li></ul> <h3 id="ssh-key"><a href="#ssh-key" aria-hidden="true" class="header-anchor">#</a> <code>SSH Key</code></h3> <p>ssh，简单来讲，就是一个秘钥，其中，id_rsa是你这台电脑的私人秘钥，不能给别人看的，id_rsa.pub是公共秘钥，可以随便给别人看。把这个公钥放在GitHub上，这样当你链接GitHub自己的账户时，它就会根据公钥匹配你的私钥，当能够相互匹配时，才能够顺利的通过git上传你的文件到GitHub上</p> <h4 id="生成"><a href="#生成" aria-hidden="true" class="header-anchor">#</a> 生成</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> config --global user.name <span class="token string">&quot;username&quot;</span>
<span class="token function">git</span> config --global user.email <span class="token string">&quot;useremail&quot;</span>
ssh-keygen -t rsa -C <span class="token string">&quot;1234@qq.com&quot;</span>
</code></pre></div><blockquote><p>回车后提示输入密码, 此处密码可以不填, 直接回车</p></blockquote> <h4 id="配置"><a href="#配置" aria-hidden="true" class="header-anchor">#</a> 配置</h4> <p>上述命令运行成功后，终端会给出存储位置</p> <div class="language-bash extra-class"><pre class="language-bash"><code>Your public key has been saved <span class="token keyword">in</span> /Users/XXX/.ssh/id_rsa.pub
</code></pre></div><p>打开上述文件，复制文件中的公钥添加到github</p> <h4 id="测试"><a href="#测试" aria-hidden="true" class="header-anchor">#</a> 测试</h4> <p>在gitbash中，查看是否成功</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">ssh</span> -T git@github.com
</code></pre></div><h3 id="开始"><a href="#开始" aria-hidden="true" class="header-anchor">#</a> 开始</h3> <ul><li>在 <code>docs/.vuepress/config.js</code> 中设置正确的 <code>base</code>
如果你打算发布到 <code>https://&lt;USERNAME&gt;.github.io/</code>，则可以省略这一步，因为 base 默认即是 &quot;/&quot;。</li> <li>在你的项目中，创建一个如下的 <code>deploy.sh</code> 文件（请自行判断去掉高亮行的注释）:</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#!/usr/bin/env sh</span>

<span class="token comment"># 确保脚本抛出遇到的错误</span>
<span class="token keyword">set</span> -e

<span class="token comment"># 生成静态文件</span>
<span class="token function">npm</span> run docs:build

<span class="token comment"># 进入生成的文件夹</span>
<span class="token function">cd</span> docs/.vuepress/dist

<span class="token comment"># 如果是发布到自定义域名</span>
<span class="token comment"># echo 'www.example.com' &gt; CNAME</span>

<span class="token function">git</span> init
<span class="token function">git</span> <span class="token function">add</span> -A
<span class="token function">git</span> commit -m <span class="token string">'deploy'</span>

<span class="token comment"># 如果发布到 https://&lt;USERNAME&gt;.github.io</span>
<span class="token comment"># git push -f git@github.com:&lt;USERNAME&gt;/&lt;USERNAME&gt;.github.io.git master</span>

<span class="token comment"># 如果发布到 https://&lt;USERNAME&gt;.github.io/&lt;REPO&gt;</span>
<span class="token comment"># git push -f git@github.com:&lt;USERNAME&gt;/&lt;REPO&gt;.git master:gh-pages</span>

<span class="token function">cd</span> -
</code></pre></div><h4 id="macos运行-sh脚本需要权限"><a href="#macos运行-sh脚本需要权限" aria-hidden="true" class="header-anchor">#</a> macOS运行.sh脚本需要权限</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">chmod</span> 777 deploy.sh
</code></pre></div><h2 id="成果"><a href="#成果" aria-hidden="true" class="header-anchor">#</a> 成果</h2> <p>打开<code>XXX.github.io</code>查看成果吧</p> <h2 id="进阶"><a href="#进阶" aria-hidden="true" class="header-anchor">#</a> 进阶</h2> <p>在vuepress中使用<a href="https://cn.vuejs.org/v2/guide/index.html" target="_blank" rel="noopener noreferrer">Vue<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="自定义vue组件"><a href="#自定义vue组件" aria-hidden="true" class="header-anchor">#</a> 自定义Vue组件</h3> <p>所有在 .vuepress/components 中找到的 *.vue 文件将会自动地被注册为全局的异步组件，如：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">.</span>
└─ <span class="token punctuation">.</span>vuepress
   └─ components
      ├─ demo<span class="token operator">-</span><span class="token number">1.</span>vue
      ├─ OtherComponent<span class="token punctuation">.</span>vue
      └─ Foo
         └─ Bar<span class="token punctuation">.</span>vue
</code></pre></div><p>你可以直接使用这些组件在任意的 Markdown 文件中（组件名是通过文件名取到的）：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>demo-1</span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>OtherComponent</span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Foo-Bar</span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><h3 id="使用elementui"><a href="#使用elementui" aria-hidden="true" class="header-anchor">#</a> 使用<a href="http://element-cn.eleme.io/#/zh-CN/component/installation" target="_blank" rel="noopener noreferrer">ElementUI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h3> <p>由于 <code>VuePress</code> 是一个标准的 Vue 应用，你可以通过创建一个 <code>.vuepress/enhanceApp.js</code> 文件来做一些应用级别的配置，当该文件存在的时候，会被导入到应用内部。<code>enhanceApp.js</code> 应该 <code>export default</code> 一个钩子函数，并接受一个包含了一些应用级别属性的对象作为参数。你可以使用这个钩子来安装一些附加的 <code>Vue</code> 插件、注册全局组件，或者增加额外的路由钩子等：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  Vue<span class="token punctuation">,</span> <span class="token comment">// VuePress 正在使用的 Vue 构造函数</span>
  options<span class="token punctuation">,</span> <span class="token comment">// 附加到根实例的一些选项</span>
  router<span class="token punctuation">,</span> <span class="token comment">// 当前应用的路由实例</span>
  siteData <span class="token comment">// 站点元数据</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...做一些其他的应用级别的优化</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="开始-2"><a href="#开始-2" aria-hidden="true" class="header-anchor">#</a> 开始</h4> <ul><li>新建<code>.vuepress/enhanceApp.js</code>文件，并引入ElementUI</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> Element <span class="token keyword">from</span> <span class="token string">'element-ui'</span>
<span class="token keyword">import</span> <span class="token string">'element-ui/lib/theme-chalk/index.css'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
                  Vue<span class="token punctuation">,</span> <span class="token comment">// VuePress 正在使用的 Vue 构造函数</span>
                  options<span class="token punctuation">,</span> <span class="token comment">// 附加到根实例的一些选项</span>
                  router<span class="token punctuation">,</span> <span class="token comment">// 当前应用的路由实例</span>
                  siteData <span class="token comment">// 站点元数据</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...做一些其他的应用级别的优化</span>
  Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Element<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>安装依赖
在<code>package.json</code>中添加</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">&quot;dependencies&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;element-ui&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;^2.7.0&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">yarn</span> <span class="token comment"># 或者 npm i</span>
</code></pre></div><ul><li>在<code>MarkDown</code>或者自定义组件中使用<code>ElementUI</code></li></ul> <h2 id="travis-ci-持续集成部署"><a href="#travis-ci-持续集成部署" aria-hidden="true" class="header-anchor">#</a> Travis CI 持续集成部署</h2> <h3 id="现有问题"><a href="#现有问题" aria-hidden="true" class="header-anchor">#</a> 现有问题</h3> <p>我们使用上述的<code>deploy.sh</code>部署到<code>git</code>后，<code>vuepress</code>是把我们项目打包后的静态资源文件<code>push</code>到<code>git</code>分支上。
上传后的项目大概是这个样子：
<div id="Picture" class="pic-container"><img src="/docs/img/vuepress/vuepress1.png"> <p></p></div> <div id="Picture" class="pic-container"><img src="/docs/img/vuepress/vuepress2.png"> <p></p></div></p> <p>这么做就有一个明显的弊端。如果这个项目不是个人博客，而是需要多人维护的项目文档，那么其他人想要修改这个文档是没办法把这些html文件<code>clone</code>到本地进行修改的。</p> <p>我们想要的是，<code>git</code>上存放我们的项目，即<code>markdown</code>文件，我们可以随时修改这些<code>markdown</code>然后<code>push</code>到线上，我们的<code>github Pages</code>则会相应的显示编译好的html。</p> <h3 id="引入"><a href="#引入" aria-hidden="true" class="header-anchor">#</a> 引入</h3> <p><a href="https://www.travis-ci.org/" target="_blank" rel="noopener noreferrer">Travis CI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>正好符合我们的要求。</p> <p>它的作用是可以监控到我们<code>git</code>资源库的每一次变更,在收到<code>push</code>请求后会为我们提供一个<code>虚拟机</code>来帮助我们执行一些任务，比如我们文档的<code>build</code>以及发布。</p> <p>这样一来我们把修改好的<code>markdown</code>推到线上后，<code>travis</code>会帮我们自动执行<code>deploy.sh</code>里的脚本。我们就可以只专注于文档本身的内容，也方便文档的维护。。</p> <h3 id="准备-2"><a href="#准备-2" aria-hidden="true" class="header-anchor">#</a> 准备</h3> <h4 id="重命名"><a href="#重命名" aria-hidden="true" class="header-anchor">#</a> 重命名</h4> <p>使用<code>xxx.github.io</code>作为<code>github Pages</code>首页是无法选择分支的，<code>git</code>会自动将<code>xxx.github.io</code>下的<code>master</code>分支当做静态资源。而我们需要的是<code>master</code>分支存放我们的项目即<code>markdown</code>，另外的分支来存放编译好的<code>html</code></p> <ul><li>更改我们的资源库名为<code>docs</code>，新建分支<code>gh pages</code>，然后在设置中将<code>github Pages</code>分支切换到<code>gh pages</code> <div id="Picture" class="pic-container"><img src="/docs/img/vuepress/vuepress3.png"> <p></p></div></li></ul> <h4 id="设置base"><a href="#设置base" aria-hidden="true" class="header-anchor">#</a> 设置<code>base</code></h4> <ul><li>由于文档地址已经更换，这里需要将<code>config.js</code>里的<code>base</code>设置为<code>/docs/</code></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  base<span class="token punctuation">:</span><span class="token string">'/docs/'</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="配置-travis-yml"><a href="#配置-travis-yml" aria-hidden="true" class="header-anchor">#</a> 配置 <code>.travis.yml</code></h4> <p>然后在项目根目录新建文件 <code>.travis.yml</code>， 这个文件内容根据你的项目而定，比如我们的项目可以是这样的</p> <div class="language-YAML extra-class"><pre class="language-yaml"><code><span class="token key atrule">language</span><span class="token punctuation">:</span> node_js
<span class="token key atrule">sudo</span><span class="token punctuation">:</span> required
<span class="token key atrule">node_js</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token string">&quot;lts/*&quot;</span>
<span class="token key atrule">cache</span><span class="token punctuation">:</span>
  <span class="token key atrule">directories</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> node_modules
<span class="token key atrule">script</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> ./deploy.sh
<span class="token key atrule">branch</span><span class="token punctuation">:</span> master
</code></pre></div><h4 id="修改deploy-sh"><a href="#修改deploy-sh" aria-hidden="true" class="header-anchor">#</a> 修改<code>deploy.sh</code></h4> <ul><li>集成 <code>travis</code> 还需要我们修改 <code>deploy.sh</code></li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#!/usr/bin/env sh</span>

<span class="token comment"># 确保脚本抛出遇到的错误</span>
<span class="token keyword">set</span> -e

<span class="token comment"># 生成静态文件</span>
<span class="token function">npm</span> run docs:build

<span class="token comment"># 进入生成的文件夹</span>
<span class="token function">cd</span> docs/.vuepress/dist

<span class="token comment"># 如果是发布到自定义域名</span>
<span class="token comment"># echo 'www.example.com' &gt; CNAME</span>

<span class="token function">git</span> init
<span class="token function">git</span> <span class="token function">add</span> -A
<span class="token function">git</span> commit -m <span class="token string">'deploy'</span>

<span class="token comment"># 如果发布到 https://&lt;USERNAME&gt;.github.io</span>
<span class="token comment"># git push -f git@github.com:7revor/7revor.github.io.git master</span>

<span class="token comment"># 如果发布到 https://&lt;USERNAME&gt;.github.io/&lt;REPO&gt;</span>
<span class="token comment"># git push -f git@github.com:&lt;USERNAME&gt;/&lt;REPO&gt;.git master:gh-pages</span>

<span class="token comment"># 如果使用 travis 持续集成</span>
<span class="token function">git</span> push -f https://<span class="token variable">${access_token}</span>@github.com/7revor/docs.git master:gh-pages

<span class="token function">cd</span> -

</code></pre></div><h3 id="travis-ci配置"><a href="#travis-ci配置" aria-hidden="true" class="header-anchor">#</a> Travis CI配置</h3> <h4 id="监听资源库"><a href="#监听资源库" aria-hidden="true" class="header-anchor">#</a> 监听资源库</h4> <ul><li>使用<code>github</code>账号登录<a href="https://www.travis-ci.org/" target="_blank" rel="noopener noreferrer">Travis CI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，选择需要自动部署的资源库
<div id="Picture" class="pic-container"><img src="/docs/img/vuepress/vuepress4.png"> <p></p></div></li></ul> <h4 id="access-token"><a href="#access-token" aria-hidden="true" class="header-anchor">#</a> Access token</h4> <ul><li><p>首先在<code>github</code>的 <code>setting -&gt; developer setting -&gt; personal access token</code>一栏点击<code>generate new token</code>， 这下面的选项全选，然后就会生成一个<code>token</code>，复制这个<code>token</code>。</p></li> <li><p>进入<code>travis</code>后台，在环境变量<code>Environment Variables</code>里设置键值对
<div id="Picture" class="pic-container"><img src="/docs/img/vuepress/vuepress5.png"> <p></p></div></p></li></ul> <h3 id="测试-2"><a href="#测试-2" aria-hidden="true" class="header-anchor">#</a> 测试</h3> <p>将我们的项目<code>push</code>到线上，观察控制台</p> <ul><li><p><code>travis</code>已经监听到我们资源库的变化，开始运行虚拟机
<div id="Picture" class="pic-container"><img src="/docs/img/vuepress/vuepress6.png"> <p></p></div></p></li> <li><p>执行<code>deploy.sh</code>中的命令
<div id="Picture" class="pic-container"><img src="/docs/img/vuepress/vuepress7.png"> <p></p></div></p></li> <li><p>任务执行成功，将<code>build</code>后的文件推送到<code>gh pages</code>分支
<div id="Picture" class="pic-container"><img src="/docs/img/vuepress/vuepress8.png"> <p></p></div></p></li> <li><p>面板显示为<code>passed</code></p></li></ul> <div id="Picture" class="pic-container"><img src="/docs/img/vuepress/vuepress9.png"> <p></p></div> <p>打开<code>xxx.github.io/docs/</code>已经可以正常访问了。</p> <p>这样我们就实现了<code>master</code>分支存放<code>markdown</code>，<code>gh pages</code>存放编译后的静态文件。</p> <p>如果有新成员加入，直接将<code>master</code>分支<code>clone</code>到本地，修改后推送到远程仓库,<code>travis</code>就会帮我们自动部署。</p> <h2 id="发布到服务器"><a href="#发布到服务器" aria-hidden="true" class="header-anchor">#</a> 发布到服务器</h2> <p>我们的需求不止要发布到<code>github Pages</code>，有时也需要发布到自己的服务器。</p> <h3 id="ssh免密登录"><a href="#ssh免密登录" aria-hidden="true" class="header-anchor">#</a> SSH免密登录</h3> <p>首先要确保自己可以通过ssh命令免密登录自己的服务器，这就需要先生成密钥对</p> <div class="language-bash extra-class"><pre class="language-bash"><code>ssh-keygen <span class="token comment"># 生成密钥对</span>
</code></pre></div><p>输入上面的指令以后一路回车即可，你会发现在用户根目录下多了<code>.ssh</code>目录，进去看一下<code>cd ~/.ssh</code>，里面有这3个文件
<div id="Picture" class="pic-container"><img src="/docs/img/vuepress/pubkey.png"> <p></p></div></p> <p>把<code>id_rsa.pub</code>里的内容，手动复制到服务器的<code>~/.ssh/authorized_keys</code>(如没有可自行创建)中去即可</p> <div class="tip custom-block"><p class="custom-block-title">提示</p> <p>还有一种方法是使用<code>ssh-copy-id root@IP</code>命令，Mac用户可能需要用<code>brew</code>安装一下<code>ssh-copy-id</code>，<code>ubuntu</code>用户应该是自带的这个命令，实现的效果与上面手动的一样</p></div> <p>登录服务器的指令如下，如果不需要密码便进入则表示成功</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">ssh</span> <span class="token variable">${username}</span>@<span class="token variable">${服务器IP}</span>
</code></pre></div> <div id="Picture" class="pic-container"><img src="/docs/img/vuepress/login.png"> <p></p></div> <h3 id="加密"><a href="#加密" aria-hidden="true" class="header-anchor">#</a> 加密</h3> <p>我们要部署到远程服务器，那么势必需要让 Travis 登录到远程服务，那么登录密码怎么处理才能保证安全？这是首先要解决的问题，明文肯定是不行的。</p> <h4 id="travis命令行工具"><a href="#travis命令行工具" aria-hidden="true" class="header-anchor">#</a> Travis命令行工具</h4> <p>使用<code>Travis命令行工具</code>将<code>id_rsa.pub</code>加密，同时将环境变量传至<code>Travis</code></p> <ul><li>首先通过 <code>Ruby</code> 的 <code>gem</code> 安装 <code>travis</code></li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>gem <span class="token function">install</span> travis
</code></pre></div><p>重试了几次发现敲完这段<code>shell</code>如同石沉大海一般，就算开了代理还是纹丝不动，没办法只能换镜像了。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>gem update --system
gem sources --add https://gems.ruby-china.org/ --remove https://rubygems.org/
</code></pre></div><p>好了，现在可以愉快的安装 <code>travis</code> 了</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> gem <span class="token function">install</span> travis
</code></pre></div><ul><li>接下来在命令行中登录 Travis</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>travis login

We need your GitHub login to identify you.
This information will not be sent to Travis CI, only to api.github.com.
The password will not be displayed.

Try running with --github-token or --auto <span class="token keyword">if</span> you don't want to enter your password anyway.

Username: xxx@xxx.xxx
Password <span class="token keyword">for</span> xxx@xxx.xxx: ***
Successfully logged <span class="token keyword">in</span> as demo<span class="token operator">!</span>
</code></pre></div><p>会要求你输入 GitHub 的账号密码，这个是走 GitHub 的服务，所以不用担心密码泄露。</p> <ul><li>将目录切换到项目根目录下，执行命令</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>travis encrypt-file ~/.ssh/id_rsa --add
</code></pre></div><p>这时在travis的环境变量中会多出两个
<div id="Picture" class="pic-container"><img src="/docs/img/vuepress/en.png"> <p></p></div></p> <p>去看一下当前目录下的 .travis.yml，会多出几行</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">before_install</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> openssl aes<span class="token punctuation">-</span>256<span class="token punctuation">-</span>cbc <span class="token punctuation">-</span>K $encrypted_d89376f3278d_key <span class="token punctuation">-</span>iv $encrypted_d89376f3278d_iv
  <span class="token punctuation">-</span> in id_rsa.enc <span class="token punctuation">-</span>out ~\/.ssh/id_rsa <span class="token punctuation">-</span>d
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">提示</p> <p>默认生成的命令可能会在/前面带转义符\，我们不需要这些转义符，手动删掉所有的转义符，否则可能在后面引发莫名的错误</p></div> <p>为保证权限正常，多加一行设置权限的 shell</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">before_install</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> openssl aes<span class="token punctuation">-</span>256<span class="token punctuation">-</span>cbc <span class="token punctuation">-</span>K $encrypted_6dc88f1910e2_key <span class="token punctuation">-</span>iv $encrypted_6dc88f1910e2_iv
  <span class="token punctuation">-</span>in id_rsa.enc <span class="token punctuation">-</span>out ~/.ssh/id_rsa <span class="token punctuation">-</span>d
  <span class="token punctuation">-</span> chmod 600 ~/.ssh/id_rsa
</code></pre></div><p>还有一点可能会用上，因为 travis 第一次登录远程服务器会出现 SSH 主机验证，这边会有一个主机信任问题。官方给出的方案是添加 addons 配置：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">addons</span><span class="token punctuation">:</span>
  <span class="token key atrule">ssh_known_hosts</span><span class="token punctuation">:</span> your<span class="token punctuation">-</span>ip
</code></pre></div><h3 id="执行部署脚本"><a href="#执行部署脚本" aria-hidden="true" class="header-anchor">#</a> 执行部署脚本</h3> <p>既然已经可以免密登录服务器了，那么写一个部署脚本，在登录时执行该脚本就可以了
在 <code>.travis.yml</code> 配置文件中写下这么两行：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">after_success</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> scp <span class="token punctuation">-</span>o StrictHostKeyChecking=no <span class="token punctuation">-</span>r docs/.vuepress/dist/* &lt;USER_NAME<span class="token punctuation">&gt;</span>@&lt;HOST_IP<span class="token punctuation">&gt;</span><span class="token punctuation">:</span>/home/ubuntu/nginx<span class="token punctuation">-</span>server/docs
</code></pre></div><p>完整的<code>.travis.yml</code>为</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">language</span><span class="token punctuation">:</span> node_js
<span class="token key atrule">sudo</span><span class="token punctuation">:</span> required
<span class="token key atrule">node_js</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> lts/*
<span class="token key atrule">before_install</span><span class="token punctuation">:</span>
 <span class="token punctuation">-</span> openssl aes<span class="token punctuation">-</span>256<span class="token punctuation">-</span>cbc <span class="token punctuation">-</span>K $encrypted_6dc88f1910e2_key <span class="token punctuation">-</span>iv $encrypted_6dc88f1910e2_iv
 <span class="token punctuation">-</span>in id_rsa.enc <span class="token punctuation">-</span>out ~/.ssh/id_rsa <span class="token punctuation">-</span>d
 <span class="token punctuation">-</span> chmod 600 ~/.ssh/id_rsa
<span class="token key atrule">addons</span><span class="token punctuation">:</span>
  <span class="token key atrule">ssh_known_hosts</span><span class="token punctuation">:</span> your<span class="token punctuation">-</span>ip
<span class="token key atrule">cache</span><span class="token punctuation">:</span>
  <span class="token key atrule">directories</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> node_modules
<span class="token key atrule">script</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> <span class="token string">&quot;./deploy.sh&quot;</span>
<span class="token key atrule">branch</span><span class="token punctuation">:</span> master

<span class="token key atrule">after_success</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> scp <span class="token punctuation">-</span>o StrictHostKeyChecking=no <span class="token punctuation">-</span>r docs/.vuepress/dist/* &lt;USER_NAME<span class="token punctuation">&gt;</span>@&lt;HOST_IP<span class="token punctuation">&gt;</span><span class="token punctuation">:</span>/home/ubuntu/nginx<span class="token punctuation">-</span>server/docs

</code></pre></div><h3 id="部署测试"><a href="#部署测试" aria-hidden="true" class="header-anchor">#</a> 部署测试</h3> <p>提交代码到远程仓库，在Travis查看log，显示成功上传
<div id="Picture" class="pic-container"><img src="/docs/img/vuepress/success.png"> <p></p></div></p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">6/20/2019, 1:18:19 AM</span></div></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/docs/Learning/publish.html">
          观察者模式&amp;&amp;发布-订阅模式
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/docs/assets/js/app.5baed39a.js" defer></script><script src="/docs/assets/js/12.725ee489.js" defer></script><script src="/docs/assets/js/2.63264812.js" defer></script>
  </body>
</html>
